({480:function(){var e=this&&this.__awaiter||function(e,i,t,o){return new(t||(t=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(e){n(e)}}function c(e){try{r(o.throw(e))}catch(e){n(e)}}function r(e){var i;e.done?a(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(l,c)}r((o=o.apply(e,i||[])).next())}))};function i(e,i,t,o,a){const n=figma.variables.createVariable(t,e.id,i);return o.forEach(((i,t)=>{n.setValueForMode(e.modes[t].modeId,i)})),a.add+=1,n}figma.showUI(__html__,{themeColors:!0,width:360,height:380}),figma.ui.onmessage=t=>e(this,void 0,void 0,(function*(){if("cancel"===t.type)figma.closePlugin();else if("load"===t.type){const e=yield figma.clientStorage.getAsync(`${figma.currentPage.id}:url`),i=yield figma.clientStorage.getAsync(`${figma.currentPage.id}:collection`),t=yield figma.clientStorage.getAsync(`${figma.currentPage.id}:columns`);void 0!==e&&void 0!==i&&void 0!==t&&figma.ui.postMessage({type:"update",url:e,collection:i,columns:t})}else if("check"===t.type){let e=figma.variables.getLocalVariableCollections().find((e=>e.name===t.collection));figma.ui.postMessage({type:"check",exist:void 0!==e,columns:void 0!==e?e.modes.map((e=>e.name)):[]})}else if("sync"===t.type){const o={type:"finish",add:0,modify:0,delete:0,changed:!1};let a=[],n=[];try{if(a=yield function(i){return e(this,void 0,void 0,(function*(){const e=yield fetch(i+"&majorDimension=COLUMNS");return(yield e.json()).values}))}(t.url),void 0===a)return void alert("The data does not exist, please check the data in your Google Sheet.")}catch(e){alert("The Google Sheet URL is invalid.")}finally{figma.ui.postMessage({type:"done"})}if(0===t.columns.length)for(let e=1;e<a.length;e++)n.push("Mode "+e);else n=t.columns;let l=figma.variables.getLocalVariableCollections().find((e=>e.name===t.collection));const c=a.length-1,r=a[0];if(void 0!==l){if(n.length!==c)return void alert("The number of collection modes and the number of data columns are different.");const e={};l.variableIds.forEach((i=>{const t=figma.variables.getVariableById(i);e[t.name]={variable:t,modified:!1}})),r.forEach(((t,r)=>{const s=[],d=t.split(".").join("_");n.forEach(((e,i)=>{i<c&&s.push(a[i+1][r])})),e[d]?(function(e,i,t,o,a){let n=!1;o.forEach(((i,o)=>{const a=e.modes[o].modeId;t.valuesByMode[a]!==i&&(t.setValueForMode(a,i),n=!0)})),n&&(a.modify+=1)}(l,0,e[d].variable,s,o),e[d].modified=!0):i(l,"STRING",d,s,o)})),Object.keys(e).forEach((i=>{e[i].modified||(e[i].variable.remove(),o.delete+=1)}))}else l=function(e,i,t){const o=figma.variables.createVariableCollection(e);return i.forEach(((e,i)=>{i<t&&(0===i?o.renameMode(o.modes[0].modeId,e.trim()):o.addMode(e.trim()))})),o}(t.collection,n,c),r.forEach(((e,t)=>{const r=[];n.forEach(((e,i)=>{i<c&&r.push(a[i+1][t])})),i(l,"STRING",e.split(".").join("_"),r,o)}));figma.ui.postMessage(o),yield figma.clientStorage.setAsync(`${figma.currentPage.id}:url`,t.url),yield figma.clientStorage.setAsync(`${figma.currentPage.id}:collection`,t.collection),yield figma.clientStorage.setAsync(`${figma.currentPage.id}:columns`,n)}}))}})[480]();