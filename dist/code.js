({480:function(){var e=this&&this.__awaiter||function(e,o,t,i){return new(t||(t=Promise))((function(n,l){function c(e){try{s(i.next(e))}catch(e){l(e)}}function a(e){try{s(i.throw(e))}catch(e){l(e)}}function s(e){var o;e.done?n(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(c,a)}s((i=i.apply(e,o||[])).next())}))};figma.showUI(__html__,{themeColors:!0,width:360,height:380}),figma.ui.onmessage=o=>e(this,void 0,void 0,(function*(){if("cancel"===o.type)figma.closePlugin();else if("load"===o.type){const e=yield figma.clientStorage.getAsync("google-sheet-sync:url"),o=yield figma.clientStorage.getAsync("google-sheet-sync:collection"),t=yield figma.clientStorage.getAsync("google-sheet-sync:columns");void 0!==e&&void 0!==o&&void 0!==t&&figma.ui.postMessage({type:"update",url:e,collection:o,columns:t})}else if("check"===o.type){let e=figma.variables.getLocalVariableCollections().find((e=>e.name===o.collection));figma.ui.postMessage({type:"check",exist:void 0!==e})}else if("sync"===o.type){let t=[],i=[];try{t=yield function(o){return e(this,void 0,void 0,(function*(){const e=yield fetch(o+"&majorDimension=COLUMNS");return(yield e.json()).values}))}(o.url)}catch(e){alert("The Google Sheet URL is invalid.")}finally{figma.ui.postMessage({type:"done"})}if(0===o.columns.length)for(let e=1;e<t.length;e++)i.push("Mode "+e);else i=o.columns;let n=figma.variables.getLocalVariableCollections().find((e=>e.name===o.collection));const l=t.length-1,c=t[0];if(void 0!==n){const e={};n.variableIds.forEach((o=>{const t=figma.variables.getVariableById(o);e[t.name]=t})),c.forEach(((o,c)=>{const a=[];i.forEach(((e,o)=>{o<l&&a.push(t[o+1][c])})),function(e,o,t,i){i.forEach(((o,i)=>{t.setValueForMode(e.modes[i].modeId,o)}))}(n,0,e[o],a)}))}else n=function(e,o,t){const i=figma.variables.createVariableCollection(e);return o.forEach(((e,o)=>{o<t&&i.addMode(e.trim())})),i.removeMode(i.modes[0].modeId),i}(o.collection,i,l),c.forEach(((e,o)=>{const c=[];i.forEach(((e,i)=>{i<l&&c.push(t[i+1][o])})),function(e,o,t,i){const n=figma.variables.createVariable(t,e.id,"STRING");i.forEach(((o,t)=>{n.setValueForMode(e.modes[t].modeId,o)}))}(n,0,e.split(".").join("_"),c)}));yield figma.clientStorage.setAsync("google-sheet-sync:columns",i),yield figma.clientStorage.setAsync("google-sheet-sync:url",o.url),yield figma.clientStorage.setAsync("google-sheet-sync:collection",o.collection),figma.closePlugin()}}))}})[480]();