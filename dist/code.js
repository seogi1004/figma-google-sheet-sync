({480:function(){var e=this&&this.__awaiter||function(e,o,t,i){return new(t||(t=Promise))((function(n,l){function c(e){try{a(i.next(e))}catch(e){l(e)}}function s(e){try{a(i.throw(e))}catch(e){l(e)}}function a(e){var o;e.done?n(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(c,s)}a((i=i.apply(e,o||[])).next())}))};figma.showUI(__html__,{themeColors:!0,height:400}),figma.ui.onmessage=o=>e(this,void 0,void 0,(function*(){if("cancel"===o.type)figma.closePlugin();else if("load"===o.type){const e=yield figma.clientStorage.getAsync("google-sheet-sync:url"),o=yield figma.clientStorage.getAsync("google-sheet-sync:collection"),t=yield figma.clientStorage.getAsync("google-sheet-sync:columns");void 0!==e&&void 0!==o&&void 0!==t&&figma.ui.postMessage({type:"update",url:e,collection:o,columns:t})}else if("sync"===o.type){let t=[];try{t=yield function(o){return e(this,void 0,void 0,(function*(){const e=yield fetch(o+"&majorDimension=COLUMNS");return(yield e.json()).values}))}(o.url)}catch(e){alert("The Google Sheet URL is invalid.")}finally{figma.ui.postMessage({type:"done"})}if(t.length-1!==o.columns.length)alert("The number of columns you set is different from the Google Sheets result.");else{let e=figma.variables.getLocalVariableCollections().find((e=>e.name===o.collection));void 0!==e&&e.remove(),e=function(e,o){const t=figma.variables.createVariableCollection(e);return o.forEach((e=>{t.addMode(e.trim())})),t.removeMode(t.modes[0].modeId),t}(o.collection,o.columns),t[0].forEach(((i,n)=>{const l=[];o.columns.forEach(((e,o)=>{l.push(t[o+1][n])})),function(e,o,t,i){const n=figma.variables.createVariable(t,e.id,"STRING");i.forEach(((o,t)=>{n.setValueForMode(e.modes[t].modeId,o)}))}(e,0,i.split(".").join("_"),l)})),yield figma.clientStorage.setAsync("google-sheet-sync:url",o.url),yield figma.clientStorage.setAsync("google-sheet-sync:collection",o.collection),yield figma.clientStorage.setAsync("google-sheet-sync:columns",o.columns),figma.closePlugin()}}}))}})[480]();