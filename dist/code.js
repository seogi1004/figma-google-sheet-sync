({480:function(){var e=this&&this.__awaiter||function(e,o,i,t){return new(i||(i=Promise))((function(n,l){function a(e){try{s(t.next(e))}catch(e){l(e)}}function c(e){try{s(t.throw(e))}catch(e){l(e)}}function s(e){var o;e.done?n(e.value):(o=e.value,o instanceof i?o:new i((function(e){e(o)}))).then(a,c)}s((t=t.apply(e,o||[])).next())}))};function o(e,o,i,t){const n=figma.variables.createVariable(i,e.id,o);return t.forEach(((o,i)=>{n.setValueForMode(e.modes[i].modeId,o)})),n}figma.showUI(__html__,{themeColors:!0,width:360,height:380}),figma.ui.onmessage=i=>e(this,void 0,void 0,(function*(){if("cancel"===i.type)figma.closePlugin();else if("load"===i.type){const e=yield figma.clientStorage.getAsync("google-sheet-sync:url"),o=yield figma.clientStorage.getAsync("google-sheet-sync:collection"),i=yield figma.clientStorage.getAsync("google-sheet-sync:columns");void 0!==e&&void 0!==o&&void 0!==i&&figma.ui.postMessage({type:"update",url:e,collection:o,columns:i})}else if("check"===i.type){let e=figma.variables.getLocalVariableCollections().find((e=>e.name===i.collection));figma.ui.postMessage({type:"check",exist:void 0!==e,columns:void 0!==e?e.modes.map((e=>e.name)):[]})}else if("sync"===i.type){let t=[],n=[];try{t=yield function(o){return e(this,void 0,void 0,(function*(){const e=yield fetch(o+"&majorDimension=COLUMNS");return(yield e.json()).values}))}(i.url)}catch(e){alert("The Google Sheet URL is invalid.")}finally{figma.ui.postMessage({type:"done"})}if(0===i.columns.length)for(let e=1;e<t.length;e++)n.push("Mode "+e);else n=i.columns;let l=figma.variables.getLocalVariableCollections().find((e=>e.name===i.collection));const a=t.length-1,c=t[0];if(void 0!==l){const e={};l.variableIds.forEach((o=>{const i=figma.variables.getVariableById(o);e[i.name]={variable:i,modified:!1}})),c.forEach(((i,c)=>{const s=[],r=i.split(".").join("_");n.forEach(((e,o)=>{o<a&&s.push(t[o+1][c])})),e[r]?(function(e,o,i,t){t.forEach(((o,t)=>{const n=e.modes[t].modeId;i.valuesByMode[n]!==o&&i.setValueForMode(n,o)}))}(l,0,e[r].variable,s),e[r].modified=!0):o(l,"STRING",r,s)})),Object.keys(e).forEach((o=>{e[o].modified||e[o].variable.remove()}))}else l=function(e,o,i){const t=figma.variables.createVariableCollection(e);return o.forEach(((e,o)=>{o<i&&(0===o?t.renameMode(t.modes[0].modeId,e.trim()):t.addMode(e.trim()))})),t}(i.collection,n,a),c.forEach(((e,i)=>{const c=[];n.forEach(((e,o)=>{o<a&&c.push(t[o+1][i])})),o(l,"STRING",e.split(".").join("_"),c)}));yield figma.clientStorage.setAsync("google-sheet-sync:columns",n),yield figma.clientStorage.setAsync("google-sheet-sync:url",i.url),yield figma.clientStorage.setAsync("google-sheet-sync:collection",i.collection),figma.closePlugin()}}))}})[480]();